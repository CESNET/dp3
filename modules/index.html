
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Dynamic Profile Processing Platform">
      
      
      
        <link rel="canonical" href="https://cesnet.github.io/dp3/modules/">
      
      
        <link rel="prev" href="../api/">
      
      
        <link rel="next" href="../configuration/">
      
      
      <link rel="icon" href="../img/dp3-favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Modules - DP3</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/slate.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#modules" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="DP3" class="md-header__button md-logo" aria-label="DP3" data-md-component="logo">
      
  <img src="../img/dp3-logo-min.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DP3
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Modules
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/CESNET/dp3" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    CESNET/dp3
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="DP3" class="md-nav__button md-logo" aria-label="DP3" data-md-component="logo">
      
  <img src="../img/dp3-logo-min.svg" alt="logo">

    </a>
    DP3
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/CESNET/dp3" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    CESNET/dp3
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Install
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data model
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../history_management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    History Management
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Modules
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Modules
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-a-new-module" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a new Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reloading-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Reloading configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-of-eid" class="md-nav__link">
    <span class="md-ellipsis">
      Type of eid
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      Callbacks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Callbacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cron-trigger-periodic-callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      CRON Trigger Periodic Callbacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callbacks-within-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Callbacks within processing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Callbacks within processing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task-on_task_start-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Task on_task_start hook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entity-allow_entity_creation-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Entity allow_entity_creation hook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entity-on_entity_creation-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Entity on_entity_creation hook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attribute-hooks" class="md-nav__link">
    <span class="md-ellipsis">
      Attribute hooks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timeseries-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Timeseries hook
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#correlation-callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      Correlation callbacks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Correlation callbacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#snapshots-correlation-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Snapshots Correlation Hook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snapshots-init-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Snapshots Init Hook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snapshots-finalize-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Snapshots Finalize Hook
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#periodic-update-callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      Periodic Update Callbacks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Periodic Update Callbacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#periodic-update-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Periodic Update Hook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#periodic-update-eid-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Periodic Update EID Hook
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-module-code-in-a-separate-thread" class="md-nav__link">
    <span class="md-ellipsis">
      Running module code in a separate thread
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../configuration/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Control
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/database/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Database
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/db_entities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Database entities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/lifetimes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Entity Lifetimes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/event_logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Event logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/history_manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    History manager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/processing_core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Processing core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/snapshots/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snapshots
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/garbage_collector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Garbage Collector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/updater/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Updater
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Code Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    dp3
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_1" id="__nav_9_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1">
            <span class="md-nav__icon md-icon"></span>
            dp3
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/api/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    api
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_1_1" id="__nav_9_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1_1">
            <span class="md-nav__icon md-icon"></span>
            api
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1_1_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/api/internal/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    internal
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_1_1_1" id="__nav_9_1_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_9_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            internal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/api/internal/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/api/internal/dp_logger/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dp_logger
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/api/internal/entity_response_models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    entity_response_models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/api/internal/helpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    helpers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/api/internal/models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/api/internal/response_models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    response_models
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/api/main/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    main
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1_1_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/api/routers/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    routers
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_1_1_3" id="__nav_9_1_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_9_1_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1_1_3">
            <span class="md-nav__icon md-icon"></span>
            routers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/api/routers/control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    control
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/api/routers/entity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    entity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/api/routers/root/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    root
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/api/routers/telemetry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    telemetry
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/bin/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    bin
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_1_2" id="__nav_9_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1_2">
            <span class="md-nav__icon md-icon"></span>
            bin
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/bin/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    api
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/bin/check/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    check
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/bin/cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cli
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/bin/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/bin/schema_update/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    schema_update
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/bin/setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/bin/worker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    worker
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/common/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    common
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_1_3" id="__nav_9_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1_3">
            <span class="md-nav__icon md-icon"></span>
            common
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/common/attrspec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    attrspec
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/common/base_module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    base_module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/common/callback_registrar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    callback_registrar
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/common/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/common/context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    context
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/common/control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    control
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/common/datapoint/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    datapoint
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/common/datatype/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    datatype
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/common/entityspec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    entityspec
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/common/mac_address/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mac_address
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/common/scheduler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    scheduler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/common/state/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    state
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/common/task/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    task
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/common/types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/common/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/core/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    core
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_1_4" id="__nav_9_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1_4">
            <span class="md-nav__icon md-icon"></span>
            core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/core/collector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    collector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/core/link_manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    link_manager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/core/updater/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    updater
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/database/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    database
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_1_5" id="__nav_9_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1_5">
            <span class="md-nav__icon md-icon"></span>
            database
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/database/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/database/database/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    database
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/database/encodings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    encodings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/database/exceptions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    exceptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/database/magic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    magic
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/database/schema_cleaner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    schema_cleaner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/database/snapshots/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    snapshots
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/history_management/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    history_management
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_1_6" id="__nav_9_1_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1_6">
            <span class="md-nav__icon md-icon"></span>
            history_management
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/history_management/history_manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    history_manager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/history_management/telemetry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    telemetry
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/scripts/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    scripts
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_1_7" id="__nav_9_1_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1_7">
            <span class="md-nav__icon md-icon"></span>
            scripts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/scripts/add_hashes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    add_hashes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/scripts/add_min_t2s/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    add_min_t2s
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/scripts/datapoint_log_converter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    datapoint_log_converter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/scripts/dummy_sender/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dummy_sender
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/scripts/migrate_snapshots/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    migrate_snapshots
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/scripts/script_runner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    script_runner
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/snapshots/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    snapshots
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_1_8" id="__nav_9_1_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1_8">
            <span class="md-nav__icon md-icon"></span>
            snapshots
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/snapshots/snapshooter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    snapshooter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/snapshots/snapshot_hooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    snapshot_hooks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/task_processing/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    task_processing
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_1_9" id="__nav_9_1_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1_9">
            <span class="md-nav__icon md-icon"></span>
            task_processing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/task_processing/task_distributor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    task_distributor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/task_processing/task_executor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    task_executor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/task_processing/task_hooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    task_hooks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/task_processing/task_queue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    task_queue
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/worker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    worker
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../scripts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scripts
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../grafana_plugin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Grafana plugin
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../extending/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Extending Documentation
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-a-new-module" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a new Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reloading-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Reloading configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-of-eid" class="md-nav__link">
    <span class="md-ellipsis">
      Type of eid
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      Callbacks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Callbacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cron-trigger-periodic-callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      CRON Trigger Periodic Callbacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callbacks-within-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Callbacks within processing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Callbacks within processing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task-on_task_start-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Task on_task_start hook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entity-allow_entity_creation-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Entity allow_entity_creation hook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entity-on_entity_creation-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Entity on_entity_creation hook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attribute-hooks" class="md-nav__link">
    <span class="md-ellipsis">
      Attribute hooks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timeseries-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Timeseries hook
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#correlation-callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      Correlation callbacks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Correlation callbacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#snapshots-correlation-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Snapshots Correlation Hook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snapshots-init-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Snapshots Init Hook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snapshots-finalize-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Snapshots Finalize Hook
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#periodic-update-callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      Periodic Update Callbacks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Periodic Update Callbacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#periodic-update-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Periodic Update Hook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#periodic-update-eid-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Periodic Update EID Hook
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-module-code-in-a-separate-thread" class="md-nav__link">
    <span class="md-ellipsis">
      Running module code in a separate thread
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="modules">Modules<a class="headerlink" href="#modules" title="Permanent link">&para;</a></h1>
<p>DP enables its users to create custom modules to perform application specific data analysis.
Modules are loaded using a plugin-like architecture and can influence the data flow from the
very first moment upon handling the data-point push request.</p>
<p>As described in the <a href="../architecture/">Architecture</a> page, DP uses a categorization of modules
into <strong>primary</strong> and <strong>secondary</strong> modules. 
The distinction between <strong>primary</strong> and <strong>secondary modules</strong> is such that primary modules
send data-points <em>into the system</em> using the HTTP API, while secondary modules <em>react
to the data present in the system</em>, e.g.: altering the data-flow in an application-specific manner,
deriving additional data based on incoming data-points or performing data correlation on entity snapshots.</p>
<p>This page covers the DP API for secondary modules, 
for primary module implementation, the <a href="../api/#insert-datapoints">API documentation</a> may be useful, 
also feel free to check out the dummy_sender script in <code>/scripts/dummy_sender.py</code>.</p>
<h2 id="creating-a-new-module">Creating a new Module<a class="headerlink" href="#creating-a-new-module" title="Permanent link">&para;</a></h2>
<p>First, make a directory that will contain all modules of the application.
For example, let's assume that the directory will be called <code>/modules/</code>.</p>
<p>As mentioned in the <a href="../configuration/processing_core/">Processing core configuration</a> page,
the modules directory must be specified in the <code>modules_dir</code> configuration option.
Let's create the main module file now - assuming the module will be called <code>my_awesome_module</code>,
create a file <code>/modules/my_awesome_module.py</code>. </p>
<p>Finally, to make the processing core load the module, add the module name to the <code>enabled_modules</code>
configuration option, e.g.:</p>
<div class="highlight"><span class="filename">Enabling the module in processing_core.yml</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nt">modules_dir</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/modules/&quot;</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nt">enabled_modules</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;my_awesome_module&quot;</span>
</code></pre></div>
<p>Here is a basic skeleton for the module file:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">dp3.common.base_module</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModule</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">dp3.common.callback_registrar</span><span class="w"> </span><span class="kn">import</span> <span class="n">CallbackRegistrar</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">dp3.common.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">PlatformConfig</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyAwesomeModule</span><span class="p">(</span><span class="n">BaseModule</span><span class="p">):</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>        <span class="n">platform_config</span><span class="p">:</span> <span class="n">PlatformConfig</span><span class="p">,</span> 
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>        <span class="n">module_config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> 
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>        <span class="n">registrar</span><span class="p">:</span> <span class="n">CallbackRegistrar</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>    <span class="p">):</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">platform_config</span><span class="p">,</span> <span class="n">module_config</span><span class="p">,</span> <span class="n">registrar</span><span class="p">)</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>        <span class="c1"># (1)!</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">PlatformConfig</span><span class="p">,</span> <span class="n">module_config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>        <span class="o">...</span> <span class="c1"># (2)!</span>
</code></pre></div>
<ol>
<li>After calling the <code>BaseModule</code> constructor, the module should and register its <a href="#callbacks">callbacks</a> in the <code>__init__</code> method.</li>
<li>The <code>load_config</code> method is called by the <code>BaseModule</code>'s <code>__init__</code> method, and is used to load the module-specific configuration. It can be also called during system runtime to reload the configuration.</li>
</ol>
<p>You should place loading of module's configuration inside the <code>load_config</code> method. 
This method is called by the <code>BaseModule</code>'s <code>__init__</code> method, as you can see bellow.
It can be also called during system runtime to reload the configuration using the <a href="../configuration/control/">Control</a> API, 
which enables you to change the module configuration without restarting the DP worker.</p>
<p>The registering of callbacks should be done in the <code>__init__</code> method however, 
as there is currently no support to alter a callback once it has been registered without restarting.</p>
<p>All modules must subclass the <a class="autorefs autorefs-internal" title="BaseModule" href="../reference/common/base_module/#dp3.common.base_module.BaseModule"><code>BaseModule</code></a> class.
If a class does not subclass the <a class="autorefs autorefs-internal" title="BaseModule" href="../reference/common/base_module/#dp3.common.base_module.BaseModule"><code>BaseModule</code></a> class,
it will not be loaded and activated by the main DP worker.
The declaration of <a class="autorefs autorefs-internal" title="BaseModule" href="../reference/common/base_module/#dp3.common.base_module.BaseModule"><code>BaseModule</code></a> is as follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">BaseModule</span><span class="p">:</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>        <span class="bp">self</span><span class="p">,</span> 
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>        <span class="n">platform_config</span><span class="p">:</span> <span class="n">PlatformConfig</span><span class="p">,</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>        <span class="n">module_config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>        <span class="n">registrar</span><span class="p">:</span> <span class="n">CallbackRegistrar</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>    <span class="p">):</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">:</span> <span class="n">SharedFlag</span> <span class="o">=</span> <span class="n">SharedFlag</span><span class="p">(</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>            <span class="kc">False</span><span class="p">,</span> <span class="n">banner</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Refresh </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>        <span class="p">)</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_config</span><span class="p">(</span><span class="n">platform_config</span><span class="p">,</span> <span class="n">module_config</span><span class="p">)</span>
</code></pre></div>
<p>As you can see, the <code>BaseModule</code> class provides a <code>refresh</code> flag used internally for refreshing
and a <code>log</code> object for the module to use for logging. </p>
<p>At initialization, each module receives a <a class="autorefs autorefs-internal" title="PlatformConfig" href="../reference/common/config/#dp3.common.config.PlatformConfig"><code>PlatformConfig</code></a>,
a <code>module_config</code> dictionary and a 
<a class="autorefs autorefs-internal" title="CallbackRegistrar" href="../reference/common/callback_registrar/#dp3.common.callback_registrar.CallbackRegistrar"><code>CallbackRegistrar</code></a>.
For the module to do anything, it must read the provided configuration from <code>platform_config</code>and
<code>module_config</code> and register callbacks to perform data analysis using the <code>registrar</code> object.
Let's go through them one at a time.</p>
<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">&para;</a></h2>
<p><a class="autorefs autorefs-internal" title="PlatformConfig" href="../reference/common/config/#dp3.common.config.PlatformConfig"><code>PlatformConfig</code></a> contains the entire DP platform configuration,
which includes the application name, worker counts, which worker processes is the module running in
and a <a class="autorefs autorefs-internal" title="ModelSpec" href="../reference/common/config/#dp3.common.config.ModelSpec"><code>ModelSpec</code></a> which contains the entity specification.</p>
<p>If you want to create configuration specific to the module itself, create a <code>.yml</code> configuration file 
named as the module itself inside the <code>modules/</code> folder,
as described in the <a href="../configuration/modules/">modules configuration page</a>.
This configuration will be then loaded into the <code>module_config</code> dictionary for convenience.
Please place code that loads the module configuration into the <code>load_config</code> method,
where you will recieve both the <code>platform_config</code> and <code>module_config</code> as arguments.</p>
<h2 id="reloading-configuration">Reloading configuration<a class="headerlink" href="#reloading-configuration" title="Permanent link">&para;</a></h2>
<p>The module configuration can be reloaded during runtime using the <a href="../configuration/control/">Control</a> API, specifically the <a href="../configuration/control/#refresh_module_config"><code>refresh_module_config</code></a> action.
This will cause the <code>load_config</code> method to be called again, with the new configuration.
For this reason it is recommended to place all configuration loading code into the <code>load_config</code> method.</p>
<p>Some callbacks may be called only sparsely in the lifetime of an entity,
and it may be useful to refresh all the values derived by the module when the configuration changes.
This is implemented for the <a href="#entity-on_entity_creation-hook"><code>on_entity_creation</code></a> 
and <a href="#attribute-hooks"><code>on_new_attr</code></a> callbacks, 
and you can enable it by passing the <code>refresh</code> keyword argument
to the callback registration. See the Callbacks section for more details.</p>
<h2 id="type-of-eid">Type of <code>eid</code><a class="headerlink" href="#type-of-eid" title="Permanent link">&para;</a></h2>
<div class="admonition tip">
<p class="admonition-title">Specifying the <code>eid</code> type</p>
<p>At runtime, the <code>eid</code> will be exactly the type as specified in the entity specification.</p>
</div>
<p>All the examples on this page will show the <code>eid</code> as a string, as that is the default type.
The type of the <code>eid</code> is can be configured in the entity specification, as is
detailed <a href="../configuration/db_entities/#entity">here</a>.</p>
<p>The typehint of the <code>eid</code> used in callback registration definitions is the <a class="autorefs autorefs-internal" title="AnyEidT


  
      module-attribute
  " href="../reference/common/datatype/#dp3.common.datatype.AnyEidT">
<code>AnyEidT</code></a> type, which is a type alias of Union of all the allowed
types of the <code>eid</code> in the entity specification.</p>
<h2 id="callbacks">Callbacks<a class="headerlink" href="#callbacks" title="Permanent link">&para;</a></h2>
<p>The <code>registrar:</code> <a class="autorefs autorefs-internal" title="CallbackRegistrar" href="../reference/common/callback_registrar/#dp3.common.callback_registrar.CallbackRegistrar"><code>CallbackRegistrar</code></a> object
provides the API to register callbacks to be called during the data processing.</p>
<h3 id="cron-trigger-periodic-callbacks">CRON Trigger Periodic Callbacks<a class="headerlink" href="#cron-trigger-periodic-callbacks" title="Permanent link">&para;</a></h3>
<p>For callbacks that need to be called periodically, 
the <a class="autorefs autorefs-internal" title="scheduler_register" href="../reference/common/callback_registrar/#dp3.common.callback_registrar.CallbackRegistrar.scheduler_register"><code>scheduler_register</code></a>
is used. 
The specific times the callback will be called are defined using the CRON schedule expressions.
Here is a simplified example from the HistoryManager module:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">registrar</span><span class="o">.</span><span class="n">scheduler_register</span><span class="p">(</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">delete_old_dps</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="s2">&quot;*/10&quot;</span>  <span class="c1"># (1)!</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="p">)</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="n">registrar</span><span class="o">.</span><span class="n">scheduler_register</span><span class="p">(</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">archive_old_dps</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hour</span><span class="o">=</span><span class="mi">2</span>  <span class="c1"># (2)!</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="p">)</span>  
</code></pre></div>
<ol>
<li>At every 10th minute.</li>
<li>Every day at 2 AM.</li>
</ol>
<p>By default, the callback will receive no arguments, but you can pass static arguments for every call
using the <code>func_args</code> and <code>func_kwargs</code> keyword arguments. 
The function return value will always be ignored.</p>
<p>The complete documentation can be found at the 
<a class="autorefs autorefs-internal" title="scheduler_register" href="../reference/common/callback_registrar/#dp3.common.callback_registrar.CallbackRegistrar.scheduler_register"><code>scheduler_register</code></a> page.
As DP utilizes the <a href="https://apscheduler.readthedocs.io/en/latest/">APScheduler</a> package internally
to realize this functionality, specifically the <a href="https://apscheduler.readthedocs.io/en/latest/modules/triggers/cron.html"><code>CronTrigger</code></a>, feel free to check their documentation for more details.</p>
<h3 id="callbacks-within-processing">Callbacks within processing<a class="headerlink" href="#callbacks-within-processing" title="Permanent link">&para;</a></h3>
<p>There are a number of possible places to register callback functions during data-point processing.</p>
<h4 id="task-on_task_start-hook">Task <code>on_task_start</code> hook<a class="headerlink" href="#task-on_task_start-hook" title="Permanent link">&para;</a></h4>
<p>A hook will be called on task processing start.
The callback is registered using the 
<a class="autorefs autorefs-internal" title="register_task_hook" href="../reference/common/callback_registrar/#dp3.common.callback_registrar.CallbackRegistrar.register_task_hook"><code>register_task_hook</code></a> method.
Required signature is <code>Callable[[DataPointTask], Any]</code>, as the return value is ignored.
It may be useful for implementing custom statistics.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">task_hook</span><span class="p">(</span><span class="n">task</span><span class="p">:</span> <span class="n">DataPointTask</span><span class="p">):</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">task</span><span class="o">.</span><span class="n">etype</span><span class="p">)</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="n">registrar</span><span class="o">.</span><span class="n">register_task_hook</span><span class="p">(</span><span class="s2">&quot;on_task_start&quot;</span><span class="p">,</span> <span class="n">task_hook</span><span class="p">)</span>
</code></pre></div>
<h4 id="entity-allow_entity_creation-hook">Entity <code>allow_entity_creation</code> hook<a class="headerlink" href="#entity-allow_entity_creation-hook" title="Permanent link">&para;</a></h4>
<p>Receives eid and Task, may prevent entity record creation (by returning False).
The callback is registered using the 
<a class="autorefs autorefs-internal" title="register_allow_entity_creation_hook" href="../reference/common/callback_registrar/#dp3.common.callback_registrar.CallbackRegistrar.register_allow_entity_creation_hook"><code>register_allow_entity_creation_hook</code></a> method.
Required signature is <code>Callable[[AnyEidT, DataPointTask], bool]</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">entity_creation</span><span class="p">(</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>        <span class="n">eid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>  <span class="c1"># (1)! </span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>        <span class="n">task</span><span class="p">:</span> <span class="n">DataPointTask</span><span class="p">,</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>    <span class="k">return</span> <span class="n">eid</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="n">registrar</span><span class="o">.</span><span class="n">register_allow_entity_creation_hook</span><span class="p">(</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>    <span class="n">entity_creation</span><span class="p">,</span> <span class="s2">&quot;test_entity_type&quot;</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="p">)</span>
</code></pre></div>
<ol>
<li><code>eid</code> may not be string, depending on the entity configuration, see <a href="#type-of-eid">Type of
   <code>eid</code></a>.</li>
</ol>
<h4 id="entity-on_entity_creation-hook">Entity <code>on_entity_creation</code> hook<a class="headerlink" href="#entity-on_entity_creation-hook" title="Permanent link">&para;</a></h4>
<p>Receives eid and Task, may return new DataPointTasks.</p>
<p>Callbacks which are called once when an entity is created are registered using the 
<a class="autorefs autorefs-internal" title="register_on_entity_creation_hook" href="../reference/common/callback_registrar/#dp3.common.callback_registrar.CallbackRegistrar.register_on_entity_creation_hook"><code>register_on_entity_creation_hook</code></a> method.
Required signature is <code>Callable[[AnyEidT, DataPointTask], list[DataPointTask]]</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">processing_function</span><span class="p">(</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>        <span class="n">eid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>  <span class="c1"># (1)! </span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>        <span class="n">task</span><span class="p">:</span> <span class="n">DataPointTask</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">DataPointTask</span><span class="p">]:</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>    <span class="n">output</span> <span class="o">=</span> <span class="n">does_work</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">DataPointTask</span><span class="p">(</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>        <span class="n">model_spec</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">model_spec</span><span class="p">,</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>        <span class="n">etype</span><span class="o">=</span><span class="s2">&quot;mac&quot;</span><span class="p">,</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>        <span class="n">eid</span><span class="o">=</span><span class="n">eid</span><span class="p">,</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>        <span class="n">data_points</span><span class="o">=</span><span class="p">[{</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>            <span class="s2">&quot;etype&quot;</span><span class="p">:</span> <span class="s2">&quot;test_enitity_type&quot;</span><span class="p">,</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>            <span class="s2">&quot;eid&quot;</span><span class="p">:</span> <span class="n">eid</span><span class="p">,</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>            <span class="s2">&quot;attr&quot;</span><span class="p">:</span> <span class="s2">&quot;derived_on_creation&quot;</span><span class="p">,</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>            <span class="s2">&quot;src&quot;</span><span class="p">:</span> <span class="s2">&quot;secondary/derived_on_creation&quot;</span><span class="p">,</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>            <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="n">output</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>        <span class="p">}]</span>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>    <span class="p">)]</span>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="n">registrar</span><span class="o">.</span><span class="n">register_on_entity_creation_hook</span><span class="p">(</span>
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>    <span class="n">processing_function</span><span class="p">,</span> <span class="s2">&quot;test_entity_type&quot;</span>
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="p">)</span>
</code></pre></div>
<ol>
<li><code>eid</code> may not be string, depending on the entity configuration, see <a href="#type-of-eid">Type of
   <code>eid</code></a>.</li>
</ol>
<p>The <code>register_on_entity_creation_hook</code> method also allows for refreshing of values derived 
by the registered hook. This can be done using the <code>refresh</code> keyword argument, (expecting a <a class="autorefs autorefs-internal" title="SharedFlag" href="../reference/common/state/#dp3.common.state.SharedFlag"><code>SharedFlag</code></a> object, which is created by default for all modules)
and the <code>may_change</code> keyword argument, which lists all the attributes that the hook may change.
For the above example, the registration would look like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">registrar</span><span class="o">.</span><span class="n">register_on_entity_creation_hook</span><span class="p">(</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    <span class="n">processing_function</span><span class="p">,</span> 
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>    <span class="s2">&quot;test_entity_type&quot;</span><span class="p">,</span> 
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>    <span class="n">refresh</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">,</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>    <span class="n">may_change</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;derived_on_creation&quot;</span><span class="p">]]</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="p">)</span>
</code></pre></div>
<h4 id="attribute-hooks">Attribute hooks<a class="headerlink" href="#attribute-hooks" title="Permanent link">&para;</a></h4>
<p>Callbacks that are called on every incoming datapoint of an attribute are registered using the 
<a class="autorefs autorefs-internal" title="register_on_new_attr_hook" href="../reference/common/callback_registrar/#dp3.common.callback_registrar.CallbackRegistrar.register_on_new_attr_hook"><code>register_on_new_attr_hook</code></a> method.
The callback allways receives eid, attribute and Task, and may return new DataPointTasks.
The required signature is <code>Callable[[AnyEidT, DataPointBase], Union[None, list[DataPointTask]]]</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">attr_hook</span><span class="p">(</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>        <span class="n">eid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>  <span class="c1"># (1)!</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>        <span class="n">dp</span><span class="p">:</span> <span class="n">DataPointBase</span><span class="p">,</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">DataPointTask</span><span class="p">]:</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>    <span class="o">...</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>    <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="n">registrar</span><span class="o">.</span><span class="n">register_on_new_attr_hook</span><span class="p">(</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>    <span class="n">attr_hook</span><span class="p">,</span> <span class="s2">&quot;test_entity_type&quot;</span><span class="p">,</span> <span class="s2">&quot;test_attr_type&quot;</span><span class="p">,</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="p">)</span>
</code></pre></div>
<ol>
<li><code>eid</code> may not be string, depending on the entity configuration, see <a href="#type-of-eid">Type of
   <code>eid</code></a>.</li>
</ol>
<p>This hook can be refreshed on configuration changes if you feel like the attribute value may change too slowly
to catch up naturally. 
This can be done using the <code>refresh</code> keyword argument, (expecting a <a class="autorefs autorefs-internal" title="SharedFlag" href="../reference/common/state/#dp3.common.state.SharedFlag"><code>SharedFlag</code></a> object, which is created by default for all modules)
and the <code>may_change</code> keyword argument, which lists all the attributes that the hook may change.
For the above example, the registration would look like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">registrar</span><span class="o">.</span><span class="n">register_on_new_attr_hook</span><span class="p">(</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>    <span class="n">attr_hook</span><span class="p">,</span> 
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>    <span class="s2">&quot;test_entity_type&quot;</span><span class="p">,</span> 
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>    <span class="s2">&quot;test_attr_type&quot;</span><span class="p">,</span> 
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>    <span class="n">refresh</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">,</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>    <span class="n">may_change</span><span class="o">=</span><span class="p">[]</span>  <span class="c1"># (1)!</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="p">)</span>
</code></pre></div>
<ol>
<li>If the hook may change the value of any attributes, they must be listed here.</li>
</ol>
<h4 id="timeseries-hook">Timeseries hook<a class="headerlink" href="#timeseries-hook" title="Permanent link">&para;</a></h4>
<p>Timeseries hooks are run before snapshot creation, and allow to process the accumulated
timeseries data into observations / plain attributes to be accessed in snapshots.</p>
<p>Callbacks are registered using the 
<a class="autorefs autorefs-internal" title="register_timeseries_hook" href="../reference/common/callback_registrar/#dp3.common.callback_registrar.CallbackRegistrar.register_timeseries_hook"><code>register_timeseries_hook</code></a> method.
The expected callback signature is <code>Callable[[str, str, list[dict]], list[DataPointTask]]</code>,
as the callback should expect entity_type, attr_type and attribute history as arguments 
and return a list of DataPointTask objects.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">timeseries_hook</span><span class="p">(</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>        <span class="n">entity_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">attr_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">attr_history</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">DataPointTask</span><span class="p">]:</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>    <span class="o">...</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>    <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="n">registrar</span><span class="o">.</span><span class="n">register_timeseries_hook</span><span class="p">(</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>    <span class="n">timeseries_hook</span><span class="p">,</span> <span class="s2">&quot;test_entity_type&quot;</span><span class="p">,</span> <span class="s2">&quot;test_attr_type&quot;</span><span class="p">,</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="p">)</span>
</code></pre></div>
<h3 id="correlation-callbacks">Correlation callbacks<a class="headerlink" href="#correlation-callbacks" title="Permanent link">&para;</a></h3>
<p>Correlation callbacks are called during snapshot creation, and allow to perform analysis
on the data of the snapshot.</p>
<h4 id="snapshots-correlation-hook">Snapshots Correlation Hook<a class="headerlink" href="#snapshots-correlation-hook" title="Permanent link">&para;</a></h4>
<p>The <a class="autorefs autorefs-internal" title="register_correlation_hook" href="../reference/common/callback_registrar/#dp3.common.callback_registrar.CallbackRegistrar.register_correlation_hook"><code>register_correlation_hook</code></a>
method expects a callable with the following signature: 
<code>Callable[[str, dict], Union[None, list[DataPointTask]]]</code>, where the first argument is the entity type, and the second is a dict
containing the current values of the entity and its linked entities.
The method can optionally return a list of DataPointTask objects to be inserted into the system.</p>
<p>As correlation hooks can depend on each other, the hook inputs and outputs must be specified
using the depends_on and may_change arguments. Both arguments are lists of lists of strings,
where each list of strings is a path from the specified entity type to individual attributes (even on linked entities).
For example, if the entity type is <code>test_entity_type</code>, and the hook depends on the attribute <code>test_attr_type1</code>,
the path is simply <code>[["test_attr_type1"]]</code>. If the hook depends on the attribute <code>test_attr_type1</code> 
of an  entity linked using <code>test_attr_link</code>, the path will be <code>[["test_attr_link", "test_attr_type1"]]</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">correlation_hook</span><span class="p">(</span><span class="n">entity_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>    <span class="o">...</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="n">registrar</span><span class="o">.</span><span class="n">register_correlation_hook</span><span class="p">(</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>    <span class="n">correlation_hook</span><span class="p">,</span> <span class="s2">&quot;test_entity_type&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;test_attr_type1&quot;</span><span class="p">]],</span> <span class="p">[[</span><span class="s2">&quot;test_attr_type2&quot;</span><span class="p">]]</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="p">)</span>
</code></pre></div>
<p>The order of running callbacks is determined automatically, based on the dependencies.
If there is a cycle in the dependencies, a <code>ValueError</code> will be raised at registration.
Also, if the provided dependency / output paths are invalid, a <code>ValueError</code> will be raised.</p>
<h4 id="snapshots-init-hook">Snapshots Init Hook<a class="headerlink" href="#snapshots-init-hook" title="Permanent link">&para;</a></h4>
<p>This hook is called before each snapshot creation run begins.
The use case is to enable your module to perform some initialization before the snapshot creation and associated correlation callbacks are executed.
Your hook will recieve no arguments, and you may return a list of DataPointTask objects to be inserted into the system from this hook.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">snapshot_init_hook</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">DataPointTask</span><span class="p">]:</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>    <span class="o">...</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>    <span class="k">return</span> <span class="p">[]</span> 
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="n">registrar</span><span class="o">.</span><span class="n">register_snapshot_init_hook</span><span class="p">(</span><span class="n">snapshot_init_hook</span><span class="p">)</span>
</code></pre></div>
<h4 id="snapshots-finalize-hook">Snapshots Finalize Hook<a class="headerlink" href="#snapshots-finalize-hook" title="Permanent link">&para;</a></h4>
<p>This hook is called after each snapshot creation run ends.
The use case is to enable your module to finish up after the snapshot creation and associated correlation callbacks are executed.
Your hook will recieve no arguments, and you may again return a list of DataPointTask objects to be inserted into the system from this hook.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">snapshot_finalize_hook</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">DataPointTask</span><span class="p">]:</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>    <span class="o">...</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>    <span class="k">return</span> <span class="p">[]</span> 
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="n">registrar</span><span class="o">.</span><span class="n">register_snapshot_finalize_hook</span><span class="p">(</span><span class="n">snapshot_init_hook</span><span class="p">)</span>
</code></pre></div>
<h3 id="periodic-update-callbacks">Periodic Update Callbacks<a class="headerlink" href="#periodic-update-callbacks" title="Permanent link">&para;</a></h3>
<p>Snapshots, which are designed to execute as quickly as possible parallelized over all workers,
may not fit every use-case for updates, especially when the updates are not tied only to the entity's state.
For example, fetching data from an external system where rate limits are a concern.</p>
<p>This is where the updater module comes in.
The updater module is responsible for updating all entities in the database over a longer time frame.
Learn more about the updater module in the <a href="../configuration/updater/">updater configuration</a> page.</p>
<h4 id="periodic-update-hook">Periodic Update Hook<a class="headerlink" href="#periodic-update-hook" title="Permanent link">&para;</a></h4>
<p>The <a class="autorefs autorefs-internal" title="register_periodic_update_hook" href="../reference/common/callback_registrar/#dp3.common.callback_registrar.CallbackRegistrar.register_periodic_update_hook"><code>register_periodic_update_hook</code></a>
method expects a callable with the following signature:
<code>Callable[[str, AnyEidT, dict], list[DataPointTask]]</code>, where the arguments are the entity type,
entity ID and master record. 
The callable should return a list of DataPointTask objects to perform (possibly empty).</p>
<p>You must also pass a unique <code>hook_id</code> string when registering the hook, the entity type and 
the period over which the hook should be called for all entities.
The following example shows how to register a periodic update hook for an entity type <code>test_entity_type</code>.
The hook will be called for all entities of this type every day.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">periodic_update_hook</span><span class="p">(</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>        <span class="n">entity_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>        <span class="n">eid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>  <span class="c1"># (1)!</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>        <span class="n">record</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">DataPointTask</span><span class="p">]:</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>    <span class="o">...</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>    <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="n">registrar</span><span class="o">.</span><span class="n">register_periodic_update_hook</span><span class="p">(</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>    <span class="n">periodic_update_hook</span><span class="p">,</span> <span class="s2">&quot;test_id&quot;</span><span class="p">,</span> <span class="s2">&quot;test_entity_type&quot;</span><span class="p">,</span> <span class="s2">&quot;1d&quot;</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="p">)</span>
</code></pre></div>
<ol>
<li><code>eid</code> may not be string, depending on the entity configuration, see <a href="#type-of-eid">Type of
   <code>eid</code></a>.</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Set a Realistic Update Period</p>
<p>Try to configure the period to match the real execution time of the registered hooks, 
as when the period is too short, the hooks may not finish before the next batch is run,
leading to missed runs and potentially even to doubling of the effective update period.</p>
</div>
<h4 id="periodic-update-eid-hook">Periodic Update EID Hook<a class="headerlink" href="#periodic-update-eid-hook" title="Permanent link">&para;</a></h4>
<p>The periodic eid update hook is similar to the previous periodic update hook, but the entity record is not passed to the callback.
This hook is useful when the entity record is not needed for the update, meaning the record data does not have to be fetched from the database.</p>
<p>The <a class="autorefs autorefs-internal" title="register_periodic_eid_update_hook" href="../reference/common/callback_registrar/#dp3.common.callback_registrar.CallbackRegistrar.register_periodic_eid_update_hook"><code>register_periodic_eid_update_hook</code></a>
method expects a callable with the following signature:
<code>Callable[[str, AnyEidT], list[DataPointTask]]</code>, where the first argument is the entity type and the second is the entity ID.
The callable should return a list of DataPointTask objects to perform (possibly empty).
All other arguments are the same as for the <a href="#periodic-update-hook">periodic update hook</a>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">periodic_eid_update_hook</span><span class="p">(</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>        <span class="n">entity_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>        <span class="n">eid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>  <span class="c1"># (1)!</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">DataPointTask</span><span class="p">]:</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>    <span class="o">...</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>    <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="n">registrar</span><span class="o">.</span><span class="n">register_periodic_eid_update_hook</span><span class="p">(</span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>    <span class="n">periodic_eid_update_hook</span><span class="p">,</span> <span class="s2">&quot;test_id&quot;</span><span class="p">,</span> <span class="s2">&quot;test_entity_type&quot;</span><span class="p">,</span> <span class="s2">&quot;1d&quot;</span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="p">)</span>
</code></pre></div>
<ol>
<li><code>eid</code> may not be string, depending on the entity configuration, see <a href="#type-of-eid">Type of
   <code>eid</code></a>.</li>
</ol>
<h2 id="running-module-code-in-a-separate-thread">Running module code in a separate thread<a class="headerlink" href="#running-module-code-in-a-separate-thread" title="Permanent link">&para;</a></h2>
<p>The module is free to run its own code in separate threads or processes.
To synchronize such code with the platform, use the <code>start()</code> and <code>stop()</code>
methods of the <code>BaseModule</code> class.
the <code>start()</code> method is called after the platform is initialized, and the <code>stop()</code> method
is called before the platform is shut down.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyModule</span><span class="p">(</span><span class="n">BaseModule</span><span class="p">):</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_thread</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;MyModule&quot;</span><span class="p">)</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_run</span><span class="p">,</span> <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a>        <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
<a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Hello world!&quot;</span><span class="p">)</span>
<a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.code.annotate"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>